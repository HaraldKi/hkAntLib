<project>
  <macrodef name="do-junit">
    <sequential>
      <delete dir="build/junit"/>
      <mkdir dir="build/junit"/>
      <junit fork="yes">
        <sysproperty key="net.sourceforge.cobertura.datafile"
                     value="build/cobertura.ser"/>
        <sysproperty key="cobertura.active" value=""/>
        <classpath>
          <pathelement location="build/cobertura/classes"/>
          <pathelement location="build/classes"/>
          <pathelement location="build/test-classes"/>
          <path refid="cobertura.classpath"/>
        </classpath>
        <formatter type="xml" usefile="true" />
        <formatter type="brief" usefile="false"/>
        <batchtest fork="yes" todir="build/junit">
          <fileset dir="tests" includes="**/*Test.java"/>
        </batchtest>
      </junit>      
    </sequential>
  </macrodef>
</project>

